
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pager2 module &#8212; Dynamic IPython</title>
    
    <link rel="stylesheet" href="../_static/scrolls.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/theme_extras.js"></script>
    <link rel="canonical" href="https://farisachugthai.github.io/dynamic-ipython/util/pager2.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="paths module" href="paths.html" />
    <link rel="prev" title="module_log module" href="module_log.html" />
  <title>Dynamic IPython --- IPython Extensions</title>

  </head><body>


    <div id="content">
      <div class="header">
        <h1 class="heading"><a href="../index.html"
          title="back to the documentation overview"><span>pager2 module</span></a></h1>
      </div>
      <div class="relnav" role="navigation" aria-label="related navigation">
        <a href="module_log.html">&laquo; <code class="xref py py-mod docutils literal notranslate"><span class="pre">module_log</span></code> module</a> |
        <a href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pager2</span></code> module</a>
        | <a href="paths.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">paths</span></code> module &raquo;</a>
      </div>
      <div id="contentwrapper">
        <div id="toc" role="navigation" aria-label="table of contents navigation">
          <h3>Table of Contents</h3>
          <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pager2</span></code> module</a><ul>
<li><a class="reference internal" href="#original-implementation">Original Implementation</a></li>
<li><a class="reference internal" href="#implementing-the-rewrite">Implementing the rewrite</a><ul>
<li><a class="reference internal" href="#revisions">Revisions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-implementation">Working Implementation</a><ul>
<li><a class="reference internal" href="#original-pydoc-implementation-and-errors">Original Pydoc Implementation and Errors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-default_profile.util.pager2">Autogenerated Pager Docs</a></li>
</ul>
</li>
</ul>

        </div>
        <div role="main">
        

<div class="section" id="pager2-module">
<h1><a class="reference internal" href="#module-default_profile.util.pager2" title="default_profile.util.pager2: Rewrite how IPython utilizes the pager on Windows."><code class="xref py py-mod docutils literal notranslate"><span class="pre">pager2</span></code></a> module<a class="headerlink" href="#pager2-module" title="Permalink to this headline">¶</a></h1>
<p>Rewrite the module that creates the <code class="docutils literal notranslate"><span class="pre">%pycat</span></code> magic.</p>
<p>In it’s current implementation, the pager gives Windows a dumb terminal and
never checks for whether <strong class="command">less</strong> is on the <span class="target" id="index-0"></span><a class="reference external" href="https://matplotlib.org/faq/environment_variables_faq.html#envvar-PATH" title="(in Matplotlib v3.2.1)"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PATH</span></code></a> or
if the user has a pager they wanna implement!</p>
<div class="section" id="original-implementation">
<h2>Original Implementation<a class="headerlink" href="#original-implementation" title="Permalink to this headline">¶</a></h2>
<p>Below is the source code for how the original <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-pycat" title="(in IPython v7.13.0)"><code class="xref std std-magic docutils literal notranslate"><span class="pre">pycat</span></code></a> was implemented.:</p>
</div>
<div class="section" id="implementing-the-rewrite">
<h2>Implementing the rewrite<a class="headerlink" href="#implementing-the-rewrite" title="Permalink to this headline">¶</a></h2>
<p>It might be best if we design this using traitlets.
They have the linking functions in the utils directory
so that we can observe if <code class="xref py py-data docutils literal notranslate"><span class="pre">sphinxify_docstring</span></code> changes, or
the value of <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EDITOR</span></code> changes, or handful of other things that we’ll
be expected to respond to.</p>
<div class="section" id="revisions">
<h3>Revisions<a class="headerlink" href="#revisions" title="Permalink to this headline">¶</a></h3>
<p>Still considering different ways of designing a new Windows specific pager
on IPython. It’s a bit difficult as the default implementation is over 10
years old, and it seems to mirror a similar setup from <a class="reference external" href="https://docs.python.org/3/library/pydoc.html#module-pydoc" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pydoc</span></code></a> where a
Windows user who doesn’t have <span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PAGER</span></code> set will use a home-brewed
<strong class="command">more</strong> lite type pager.</p>
<p>However, I haven’t found anywhere in the docs where this is mentioned which
is frustrating, in addition to the fact that both APIs are written with no
ability to change or configure things in mind.</p>
</div>
</div>
<div class="section" id="working-implementation">
<h2>Working Implementation<a class="headerlink" href="#working-implementation" title="Permalink to this headline">¶</a></h2>
<p>Oct 28, 2019:</p>
<p>Just ran this in the shell and I’m really pleased with it.</p>
<p>It utilizes the <code class="xref py py-attr docutils literal notranslate"><span class="pre">autocall</span></code> functionality of IPython, works with the
<code class="docutils literal notranslate"><span class="pre">pycolorize</span></code> utils, uses the <code class="xref py py-obj docutils literal notranslate"><span class="pre">page</span></code> core function.</p>
<p>If the user doesn’t provide an argument, then just show them the last input
they gave us especially since that var is <strong>guaranteed</strong> to always
be there.</p>
<p>I believe that this magic gets loaded automatically on startup now.</p>
<div class="section" id="original-pydoc-implementation-and-errors">
<span id="pydoc-bug"></span><h3>Original Pydoc Implementation and Errors<a class="headerlink" href="#original-pydoc-implementation-and-errors" title="Permalink to this headline">¶</a></h3>
<p>Running pydoc with PAGER set on Windows doesn’t catch the KeyboardInterrupt…</p>
<p>Outside of the stupid traceback, that command worked perfectly for me.</p>
<p>I have <span class="target" id="index-3"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PAGER</span></code> set on Windows {which I realize isn’t typical},
however we should re-use this implementation entirely and cut
<a class="reference external" href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.core.page.html#IPython.core.page.page" title="(in IPython v7.13.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IPython.core.page.page</span></code></a> out.</p>
<p>Also worth noting <a class="reference external" href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.core.payloadpage.html#IPython.core.payloadpage.page" title="(in IPython v7.13.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IPython.core.payloadpage.page</span></code></a>.:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [63]: </span><span class="n">pydoc</span><span class="o">.</span><span class="n">pipepager</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">arg</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PAGER&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Despite the source code of the std lib stating that pipes are completely
broken on windows, this worked just fine for me.</p>
<p>Define arg as an object like if you pass a string it’ll give you the help
message for a str.</p>
<p><a class="reference external" href="https://docs.python.org/3/library/inspect.html#module-inspect" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">inspect</span></code></a> has a million more methods and pydoc does too so possibly change
the <a class="reference external" href="https://docs.python.org/3/library/inspect.html#inspect.getdoc" title="(in Python v3.8)"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect.getdoc()</span></code></a> part, but honestly that one line is 80% of the way to
what I’ve been trying to do.</p>
</div>
</div>
<div class="section" id="module-default_profile.util.pager2">
<span id="autogenerated-pager-docs"></span><h2>Autogenerated Pager Docs<a class="headerlink" href="#module-default_profile.util.pager2" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="default_profile.util.pager2.pypager">
<span id="default_profile.util.pager2.PyPager"></span><em class="property">class </em><code class="sig-name descname">PyPager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">use_pager</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/default_profile/util/pager2.html#PyPager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#default_profile.util.pager2.pypager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.core.magic.html#IPython.core.magic.Magics" title="(in IPython v7.13.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">IPython.core.magic.Magics</span></code></a></p>
<p>A pager if you’re outside of IPython.</p>
<dl class="py method">
<dt id="default_profile.util.pager2.pypager.__init__">
<span id="default_profile.util.pager2.PyPager.__init__"></span><code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">use_pager=True</em>, <em class="sig-param">\*\*kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/default_profile/util/pager2.html#PyPager.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#default_profile.util.pager2.pypager.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the class.</p>
<p>This occurs by binding an optional text to the instance and determining
whether to use a pager or output by printing to the shell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul>
<li><p><strong>text</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – Text to page</p></li>
<li><p><strong>use_pager</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print to the shell or pipe to a pager.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="default_profile.util.pager2.pypager.call">
<span id="default_profile.util.pager2.PyPager.call"></span><code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">text</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/default_profile/util/pager2.html#PyPager.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#default_profile.util.pager2.pypager.call" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="default_profile.util.pager2.pypager.magics">
<span id="default_profile.util.pager2.PyPager.magics"></span><code class="sig-name descname">magics</code><em class="property"> = {'cell': {}, 'line': {}}</em><a class="headerlink" href="#default_profile.util.pager2.pypager.magics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="default_profile.util.pager2.pypager.registered">
<span id="default_profile.util.pager2.PyPager.registered"></span><code class="sig-name descname">registered</code><em class="property"> = True</em><a class="headerlink" href="#default_profile.util.pager2.pypager.registered" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="default_profile.util.pager2.blocking_pager">
<code class="sig-name descname">blocking_pager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">text</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/default_profile/util/pager2.html#blocking_pager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#default_profile.util.pager2.blocking_pager" title="Permalink to this definition">¶</a></dt>
<dd><p>A pipe pager that works on Windows. Doesn’t colorize anything.</p>
<p>It’s better that way though as we can send the contents elsewhere to
be highlighted.</p>
<p>Better to keep things separated.</p>
</dd></dl>

<dl class="py function">
<dt id="default_profile.util.pager2.get_docs_and_page">
<code class="sig-name descname">get_docs_and_page</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/default_profile/util/pager2.html#get_docs_and_page"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#default_profile.util.pager2.get_docs_and_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Resourceful way to parse sys.argv and then expand a <code class="docutils literal notranslate"><span class="pre">*args</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="default_profile.util.pager2.were_in_ipython">
<code class="sig-name descname">were_in_ipython</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/default_profile/util/pager2.html#were_in_ipython"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#default_profile.util.pager2.were_in_ipython" title="Permalink to this definition">¶</a></dt>
<dd><p>Call ipython to make sure we’re really in it.</p>
</dd></dl>

<dl class="py function">
<dt id="default_profile.util.pager2.provided_or_last">
<code class="sig-name descname">provided_or_last</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shell</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/default_profile/util/pager2.html#provided_or_last"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#default_profile.util.pager2.provided_or_last" title="Permalink to this definition">¶</a></dt>
<dd><p>Either run a provided code_cell from a user or rerun their last input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul>
<li><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – str to page</p></li>
<li><p><strong>shell</strong> (<em>IPython instance</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Found user code.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>code_to_page</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>We should consider using something else to find user code.</p>
</dd></dl>

<dl class="py function">
<dt id="default_profile.util.pager2.c">
<code class="sig-name descname">c</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/default_profile/util/pager2.html#c"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#default_profile.util.pager2.c" title="Permalink to this definition">¶</a></dt>
<dd><p>Intentionally abbreviated function call to <code class="xref py py-obj docutils literal notranslate"><span class="pre">%pycat</span></code>.</p>
<p>This implementation has the added benefit of wrapping everything in a
try/except that catches KeyboardInterrupts and EOFErrors because pycat
doesn’t.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The internal variable namespace, or an instance of the magic
<code class="xref py py-class docutils literal notranslate"><span class="pre">NameSpaceMagics</span></code>
can display the magics through the attribute …magics.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – String to page.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


        </div>
      </div>
    </div>

    <div class="footer" role="contentinfo">
      Last updated on Apr 05, 2020.
    </div>
  </body>
</html>