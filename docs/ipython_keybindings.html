
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>2. Keybindings in IPython &#8212; Dynamic IPython 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/C:\Users\faris\projects\dynamic_ipython\docs\source\_static\pyramid.css_t" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. IPython Magics" href="magics.html" />
    <link rel="prev" title="1. IPython Startup Scripts" href="startup.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="magics.html" title="3. IPython Magics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="startup.html" title="1. IPython Startup Scripts"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Dynamic IPython 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-ipython_keybindings">
<span id="keybindings-in-ipython"></span><h1>2. Keybindings in IPython<a class="headerlink" href="#module-ipython_keybindings" title="Permalink to this headline">¶</a></h1>
<div class="section" id="interactively-binding-keys">
<h2>2.1. Interactively Binding Keys<a class="headerlink" href="#interactively-binding-keys" title="Permalink to this headline">¶</a></h2>
<p>If we would like to add extra keybindings to the IPython shell, we can utilize
a few functions built into the <a class="reference external" href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.terminal.interactiveshell.html#module-IPython.terminal.interactiveshell" title="(in IPython v7.5.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">IPython.terminal.interactiveshell</span></code></a> module,
in addition, to utilizing the expansive <code class="xref py py-mod docutils literal notranslate"><span class="pre">prompt_toolkit</span></code> library.</p>
<p>First we’ll initialize a global instance of the shell.</p>
<p>Then import the function <code class="xref py py-func docutils literal notranslate"><span class="pre">create_ipython_shortcuts()</span></code>
and initialize a <code class="xref py py-class docutils literal notranslate"><span class="pre">KeyBindings</span></code>
instance.</p>
<p>The attributes associated with <code class="xref py py-func docutils literal notranslate"><span class="pre">create_ipython_shortcuts()</span></code>
are as follows:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">get_ipython</span>
<span class="gp">   ...: </span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">IPython.terminal.interactiveshell</span> <span class="kn">import</span> <span class="n">create_ipython_shortcuts</span>
<span class="gp">   ...: </span><span class="o">&gt;&gt;&gt;</span> <span class="n">ip</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span>
<span class="gp">   ...: </span><span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">create_ipython_shortcuts</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
<span class="gp">   ...: </span><span class="o">&gt;&gt;&gt;</span> <span class="c1"># This will give you the following methods</span>
<span class="gp">   ...: </span><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="gp">   ...: </span>    <span class="p">[</span><span class="s1">&#39;_KeyBindings__version&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="o">...</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;_abc_impl&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;_clear_cache&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;_get_bindings_for_keys_cache&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;_get_bindings_starting_with_keys_cache&#39;</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;_version&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;add&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;add_binding&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;bindings&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;get_bindings_for_keys&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;get_bindings_starting_with_keys&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;remove&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;remove_binding&#39;</span><span class="p">]</span>
<span class="gp">   ...: </span>
<span class="gt">  File</span><span class="nn"> &quot;&lt;ipython-input-1-0ad2178af322&gt;&quot;</span><span class="gt">, line </span><span class="mi">7</span>
    <span class="p">[</span><span class="s1">&#39;_KeyBindings__version&#39;</span><span class="p">,</span>
    <span class="o">^</span>
<span class="ne">IndentationError</span>: unexpected indent
</pre></div>
</div>
<p>That file also gives a good example of how to bind keys.</p>
<div class="section" id="original-file-implementation">
<h3>2.1.1. Original File Implementation<a class="headerlink" href="#original-file-implementation" title="Permalink to this headline">¶</a></h3>
<p>Go to the IPython root dir. This could be named something to the effect of
<a class="reference external" href="~/miniconda3/lib/python3.7/site-packages/IPython/">~/miniconda3/lib/python3.7/site-packages/IPython/</a></p>
<p>To find it programtically, one can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">IPython.paths</span> <span class="k">import</span> <span class="n">get_ipython_package_dir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">get_ipython_package_dir</span><span class="p">())</span>
</pre></div>
</div>
<p>Then navigate to the root of that directory.</p>
<p><code class="docutils literal notranslate"><span class="pre">%cd</span> <span class="pre">/usr/lib/python3.7/site-packages/IPython</span></code></p>
<p>Go to the terminal package.
<code class="docutils literal notranslate"><span class="pre">%cd</span> <span class="pre">terminal</span></code>
<code class="docutils literal notranslate"><span class="pre">%pycat</span> <span class="pre">shortcuts</span></code></p>
<p>Up at the top you have the keybindings <a class="reference external" href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.html#module-IPython" title="(in IPython v7.5.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">IPython</span></code></a> ships with listed
for ya!</p>
</div>
</div>
<div class="section" id="official-ipython-documentation">
<h2>2.2. Official IPython Documentation<a class="headerlink" href="#official-ipython-documentation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">prompt_toolkit.key_binding.registry</span> <span class="k">import</span> <span class="n">Registry</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.key_binding.defaults</span> <span class="k">import</span> <span class="n">load_key_bindings</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="k">import</span> <span class="n">get_ipython</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.enums</span> <span class="k">import</span> <span class="n">DEFAULT_BUFFER</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.keys</span> <span class="k">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.filters</span> <span class="k">import</span> <span class="n">HasFocus</span><span class="p">,</span> <span class="n">HasSelection</span><span class="p">,</span> <span class="n">ViInsertMode</span>
<span class="n">ip</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span>
<span class="n">insert_mode</span> <span class="o">=</span> <span class="n">ViInsertMode</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">insert_unexpected</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;From the IPython examples on keybinding configuration.&quot;&quot;&quot;</span>
    <span class="n">buf</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">current_buffer</span>
    <span class="n">buf</span><span class="o">.</span><span class="n">insert_text</span><span class="p">(</span><span class="s1">&#39;The Spanish Inquisition&#39;</span><span class="p">)</span>
    <span class="c1"># Register the shortcut if IPython is using prompt_toolkit</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="s1">&#39;pt_cli&#39;</span><span class="p">):</span>
        <span class="n">registry</span> <span class="o">=</span> <span class="n">ip</span><span class="o">.</span><span class="n">pt_cli</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">key_bindings_registry</span>

        <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlN</span><span class="p">,</span>
                 <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span>
                              <span class="o">&amp;</span> <span class="o">~</span><span class="n">HasSelection</span><span class="p">()</span>
                         <span class="o">&amp;</span> <span class="n">insert_mode</span><span class="p">))(</span><span class="n">insert_unexpected</span><span class="p">)</span>
</pre></div>
</div>
<p>The documentation also shows a way of adding a Conditional Filter
<em>a la Prompt Toolkit</em> to the Enter key. Looks like it invokes some
<code class="xref py py-class docutils literal notranslate"><span class="pre">prompt_toolkit.application.Buffer()</span></code> type code.</p>
<p>Continue on in this fashion for as long as you need IPython barely comes
with any keybindings. I’m going to drop 1 that I thought was interesting
though.
<em>Also because i didn’t know or remember these were keybindings.</em></p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ctrl+J == Enter, seemingly</span>
<span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlJ</span><span class="p">,</span>
                     <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span>
                     <span class="o">&amp;</span> <span class="o">~</span><span class="n">HasSelection</span><span class="p">()</span>
                     <span class="o">&amp;</span> <span class="n">insert_mode</span>
                     <span class="p">))</span>
                     <span class="p">(</span><span class="n">return_handler</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="pure-prompt-toolkit-way-of-rebinding-keys">
<h3>2.2.1. Pure Prompt Toolkit Way of Rebinding Keys<a class="headerlink" href="#pure-prompt-toolkit-way-of-rebinding-keys" title="Permalink to this headline">¶</a></h3>
<p>There are 2 different sections on rebinding keys from Prompt Toolkit.</p>
<p>The first time it’s mentioned is in the <span class="xref std std-doc">prompt_toolkit.asking_for_input</span> document.:</p>
<div class="section" id="adding-custom-key-bindings">
<h4>2.2.1.1. Adding custom key bindings<a class="headerlink" href="#adding-custom-key-bindings" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>By default, every prompt already has a set of key bindings which implements
the usual Vi or Emacs behaviour.</p>
<p>We can extend this by passing another KeyBindings instance to the
key_bindings argument of the prompt() function or the PromptSession class.</p>
<p>An example of a prompt that prints ‘hello world’ when Control-T is pressed.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">prompt_toolkit</span> <span class="k">import</span> <span class="n">prompt</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.application</span> <span class="k">import</span> <span class="n">run_in_terminal</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.key_binding</span> <span class="k">import</span> <span class="n">KeyBindings</span>

<span class="n">bindings</span> <span class="o">=</span> <span class="n">KeyBindings</span><span class="p">()</span>

<span class="nd">@bindings</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;c-t&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="s2">&quot; Say &#39;hello&#39; when `c-t` is pressed. &quot;</span>
    <span class="k">def</span> <span class="nf">print_hello</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">)</span>
    <span class="n">run_in_terminal</span><span class="p">(</span><span class="n">print_hello</span><span class="p">)</span>

<span class="nd">@bindings</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;c-x&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="s2">&quot; Exit when `c-x` is pressed. &quot;</span>
    <span class="n">event</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="n">text</span> <span class="o">=</span> <span class="n">prompt</span><span class="p">(</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="n">key_bindings</span><span class="o">=</span><span class="n">bindings</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;You said: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that we use run_in_terminal() for the first key binding. This ensures
that the output of the print-statement and the prompt don’t mix up. If the
key bindings doesn’t print anything, then it can be handled directly
without nesting functions.</p>
</div></blockquote>
</div>
<div class="section" id="enable-key-bindings-according-to-a-condition">
<h4>2.2.1.2. Enable key bindings according to a condition<a class="headerlink" href="#enable-key-bindings-according-to-a-condition" title="Permalink to this headline">¶</a></h4>
<p>:</p>
<blockquote>
<div><p>Often, some key bindings can be enabled or disabled according to a certain
condition. For instance, the Emacs and Vi bindings will never be active at
the same time, but it is possible to switch between Emacs and Vi bindings
at run time.</p>
<p>In order to enable a key binding according to a certain condition, we have
to pass it a Filter, usually a Condition instance. (Read more about filters.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">prompt_toolkit</span> <span class="k">import</span> <span class="n">prompt</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.filters</span> <span class="k">import</span> <span class="n">Condition</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.key_binding</span> <span class="k">import</span> <span class="n">KeyBindings</span>

<span class="n">bindings</span> <span class="o">=</span> <span class="n">KeyBindings</span><span class="p">()</span>

<span class="nd">@Condition</span>
<span class="k">def</span> <span class="nf">is_active</span><span class="p">():</span>
    <span class="s2">&quot; Only activate key binding on the second half of each minute. &quot;</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">second</span> <span class="o">&gt;</span> <span class="mi">30</span>

<span class="nd">@bindings</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;c-t&#39;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">is_active</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="c1"># ...</span>
    <span class="k">pass</span>

<span class="n">prompt</span><span class="p">(</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="n">key_bindings</span><span class="o">=</span><span class="n">bindings</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="dynamically-switch-between-emacs-and-vi-mode">
<h4>2.2.1.3. Dynamically switch between Emacs and Vi mode<a class="headerlink" href="#dynamically-switch-between-emacs-and-vi-mode" title="Permalink to this headline">¶</a></h4>
<p>This is the part I’m most interested in, as we’re going to try coming up with
a new set of keybindings that blends together Emacs insert mode and Vim command mode.</p>
<p>Ideally this would be tied together as 1 set of keybindings so that we don’t run into
key binding collisions. A <code class="xref py py-class docutils literal notranslate"><span class="pre">prompt_toolkit.key_bindings.DynamicKeyBindings</span></code>
might be useful. Bring it together with <code class="xref py py-func docutils literal notranslate"><span class="pre">prompt_toolkit.key_bindings.merge_key_bindings()</span></code>:</p>
<blockquote>
<div><p>The Application has an editing_mode attribute. We can change the key
bindings by changing this attribute from EditingMode.VI to EditingMode.EMACS.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">prompt_toolkit</span> <span class="k">import</span> <span class="n">prompt</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.application.current</span> <span class="k">import</span> <span class="n">get_app</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.filters</span> <span class="k">import</span> <span class="n">Condition</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.key_binding</span> <span class="k">import</span> <span class="n">KeyBindings</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
    <span class="c1"># Create a set of key bindings.</span>
    <span class="n">bindings</span> <span class="o">=</span> <span class="n">KeyBindings</span><span class="p">()</span>

    <span class="c1"># Add an additional key binding for toggling this flag.</span>
    <span class="nd">@bindings</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;f4&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="s2">&quot; Toggle between Emacs and Vi mode. &quot;</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">app</span>

        <span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">editing_mode</span> <span class="o">==</span> <span class="n">EditingMode</span><span class="o">.</span><span class="n">VI</span><span class="p">:</span>
            <span class="n">app</span><span class="o">.</span><span class="n">editing_mode</span> <span class="o">=</span> <span class="n">EditingMode</span><span class="o">.</span><span class="n">EMACS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">app</span><span class="o">.</span><span class="n">editing_mode</span> <span class="o">=</span> <span class="n">EditingMode</span><span class="o">.</span><span class="n">VI</span>

    <span class="c1"># Add a toolbar at the bottom to display the current input mode.</span>
    <span class="k">def</span> <span class="nf">bottom_toolbar</span><span class="p">():</span>
        <span class="s2">&quot; Display the current input mode. &quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Vi&#39;</span> <span class="k">if</span> <span class="n">get_app</span><span class="p">()</span><span class="o">.</span><span class="n">editing_mode</span> <span class="o">==</span> <span class="n">EditingMode</span><span class="o">.</span><span class="n">VI</span> <span class="k">else</span> <span class="s1">&#39;Emacs&#39;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">(</span><span class="s1">&#39;class:toolbar&#39;</span><span class="p">,</span> <span class="s1">&#39; [F4] </span><span class="si">%s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">text</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="n">prompt</span><span class="p">(</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="n">key_bindings</span><span class="o">=</span><span class="n">bindings</span><span class="p">,</span> <span class="n">bottom_toolbar</span><span class="o">=</span><span class="n">bottom_toolbar</span><span class="p">)</span>

<span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>Read more about key bindings …</p>
</div>
<div class="section" id="using-control-space-for-completion">
<h4>2.2.1.4. Using control-space for completion<a class="headerlink" href="#using-control-space-for-completion" title="Permalink to this headline">¶</a></h4>
<p>:</p>
<blockquote>
<div><p>An popular short cut that people sometimes use it to use control-space for
opening the autocompletion menu instead of the tab key. This can be done
with the following key binding.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kb</span> <span class="o">=</span> <span class="n">KeyBindings</span><span class="p">()</span>

<span class="nd">@kb</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;c-space&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="s2">&quot; Initialize autocompletion, or select the next completion. &quot;</span>
    <span class="n">buff</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">current_buffer</span>
    <span class="k">if</span> <span class="n">buff</span><span class="o">.</span><span class="n">complete_state</span><span class="p">:</span>
        <span class="n">buff</span><span class="o">.</span><span class="n">complete_next</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">buff</span><span class="o">.</span><span class="n">start_completion</span><span class="p">(</span><span class="n">select_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="progress-bar-section">
<h4>2.2.1.5. Progress Bar Section<a class="headerlink" href="#progress-bar-section" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>from prompt_toolkit import HTML
from prompt_toolkit.key_binding import KeyBindings
from prompt_toolkit.patch_stdout import patch_stdout
from prompt_toolkit.shortcuts import ProgressBar

import time

bottom_toolbar = HTML(&#39; &lt;b&gt;[f]&lt;/b&gt; Print &quot;f&quot; &lt;b&gt;[x]&lt;/b&gt; Abort.&#39;)

# Create custom key bindings first.
kb = KeyBindings()
cancel = [False]

@kb.add(&#39;f&#39;)
def _(event):
    print(&#39;You pressed `f`.&#39;)

@kb.add(&#39;x&#39;)
def _(event):
    &quot; Send Abort (control-c) signal. &quot;
    cancel[0] = True
    os.kill(os.getpid(), signal.SIGINT)

# Use `patch_stdout`, to make sure that prints go above the
# application.
with patch_stdout():
    with ProgressBar(key_bindings=kb, bottom_toolbar=bottom_toolbar) as pb:
        for i in pb(range(800)):
            time.sleep(.01)

            # Stop when the cancel flag has been set.
            if cancel[0]:
                break

Notice that we use patch_stdout() to make printing text possible while the
progress bar is displayed. This ensures that printing happens above the
progress bar.

.. lol what is that typo. mean thread???

Further, when “x” is pressed, we set a cancel flag, which stops the progress.
It would also be possible to send SIGINT to the mean thread, but that’s not
always considered a clean way of cancelling something.

In the example above, we also display a toolbar at the bottom which shows the
key bindings.
</pre></div>
</div>
</div>
<div class="section" id="conditional-key-bindings">
<h4>2.2.1.6. Conditional Key Bindings<a class="headerlink" href="#conditional-key-bindings" title="Permalink to this headline">¶</a></h4>
<p>Then again as a more advanced section.:</p>
<blockquote>
<div><p>It is also possible to combine multiple registries. We do this in the default
key bindings. There are some registries that contain Emacs bindings, while
others contain the Vi bindings. They are merged together using a
<code class="xref py py-class docutils literal notranslate"><span class="pre">prompt_toolkit.bindings.MergedRegistry`</span></code>.</p>
<p>We also have a <code class="docutils literal notranslate"><span class="pre">ConditionalRegistry</span></code> object that can enable/disable a group
of key bindings at once.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">Registry</span><span class="p">()</span>

<span class="nd">@r</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlX</span><span class="p">,</span> <span class="n">Keys</span><span class="o">.</span><span class="n">ControlC</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">INSERT</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A quick snippet to give you a flavor of the syntax.</span>

<span class="sd">    Gotta figure out what&#39;s up with that filter param over there.</span>
<span class="sd">    02/24/2019: The ``filter`` parameter is optional it just helps specify things.</span>

<span class="sd">    Luckily I think that keybindings actually don&#39;t need function bodies</span>
<span class="sd">    The decorator&#39;s doing all the heavy lifting for ya! I think...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Handle ControlX-ControlC key sequence.</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">check_defaults</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;What are the default keybindings we have here?</span>

<span class="sd">    Err I suppose I should say what does Prompt Toolkit export by default</span>
<span class="sd">    because I&#39;m not 100% sure that ip imports everything or doesn&#39;t modify</span>
<span class="sd">    anything along the way.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">registry</span> <span class="o">=</span> <span class="n">load_key_bindings</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">registry</span><span class="o">.</span><span class="n">key_bindings</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="what-happened-here">
<h2>2.3. What happened here?<a class="headerlink" href="#what-happened-here" title="Permalink to this headline">¶</a></h2>
<p>I wanted to try experimenting with the code to dynamically set up a toggle
between Emacs and Vim.</p>
<p>I didn’t think that when the docstring said “DynamicKeyBindings takes a callable”
that they meant the IPython global instance.</p>
<p>But I was curious what would happen.</p>
<p>Doing so actually created an embedded IPython instance that you can now toggle on and off.</p>
<p>And IPython allows you to do so with their <code class="docutils literal notranslate"><span class="pre">dummy_mode</span></code> attribute; which I’ve never
known about. The lack of a useful docstring to introspect the object with didn’t help at all.</p>
<p>So maybe check out the source code for <a class="reference external" href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.terminal.embed.html#module-IPython.terminal.embed" title="(in IPython v7.5.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">IPython.terminal.embed</span></code></a>. But yeah I have
no idea what the fuck happened here.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>In[7]: prompt_toolkit.key_binding.DynamicKeyBindings(_ip)
Out[7]: &lt;prompt_toolkit.key_binding.key_bindings.DynamicKeyBindings at 0x189d84cae10&gt;
In[8]: t = prompt_toolkit.key_binding.DynamicKeyBindings(_ip)
  ...:
In[9]: t?
Type:        DynamicKeyBindings
String form: &lt;prompt_toolkit.key_binding.key_bindings.DynamicKeyBindings object at 0x00000189D84CA160&gt;
File:        c:\tools\miniconda3\envs\dynamic\lib\site-packages\prompt_toolkit\key_binding\key_bindings.py
Docstring:
KeyBindings class that can dynamically returns any KeyBindings.

:param get_key_bindings: Callable that returns a :class:`.KeyBindings` instance.

In[10]: t
Out[10]: &lt;prompt_toolkit.key_binding.key_bindings.DynamicKeyBindings at 0x189d84ca160&gt;
In[11]: dir(t)
Out[11]:
[&#39;_DynamicKeyBindings__version&#39;,
 &#39;__abstractmethods__&#39;,
 &#39;__class__&#39;,
 &#39;__delattr__&#39;,
 &#39;__dict__&#39;,
 &#39;__dir__&#39;,
 &#39;__doc__&#39;,
 &#39;__eq__&#39;,
 &#39;__format__&#39;,
 &#39;__ge__&#39;,
 &#39;__getattribute__&#39;,
 &#39;__gt__&#39;,
 &#39;__hash__&#39;,
 &#39;__init__&#39;,
 &#39;__init_subclass__&#39;,
 &#39;__le__&#39;,
 &#39;__lt__&#39;,
 &#39;__module__&#39;,
 &#39;__ne__&#39;,
 &#39;__new__&#39;,
 &#39;__reduce__&#39;,
 &#39;__reduce_ex__&#39;,
 &#39;__repr__&#39;,
 &#39;__setattr__&#39;,
 &#39;__sizeof__&#39;,
 &#39;__str__&#39;,
 &#39;__subclasshook__&#39;,
 &#39;__weakref__&#39;,
 &#39;_abc_impl&#39;,
 &#39;_dummy&#39;,
 &#39;_last_child_version&#39;,
 &#39;_update_cache&#39;,
 &#39;_version&#39;,
 &#39;bindings&#39;,
 &#39;get_bindings_for_keys&#39;,
 &#39;get_bindings_starting_with_keys&#39;,
 &#39;get_key_bindings&#39;]
In[12]: t.bindings
Python 3.7.3 (default, Apr 24 2019, 15:29:51) [MSC v.1915 64 bit (AMD64)]
Type &#39;copyright&#39;, &#39;credits&#39; or &#39;license&#39; for more information
IPython 7.5.0 -- An enhanced Interactive Python. Type &#39;?&#39; for help.

In [10]: &gt;? exi
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
C:\tools\miniconda3\envs\dynamic\lib\site-packages\prompt_toolkit\key_binding\key_bindings.py in &lt;module&gt;
----&gt; 1 exi

NameError: name &#39;exi&#39; is not defined

In [11]: &gt;? exit

Out[12]: []
In[13]: type(t)
Out[13]: prompt_toolkit.key_binding.key_bindings.DynamicKeyBindings
In[14]: t.get_key_bindings()
Python 3.7.3 (default, Apr 24 2019, 15:29:51) [MSC v.1915 64 bit (AMD64)]
Type &#39;copyright&#39;, &#39;credits&#39; or &#39;license&#39; for more information
IPython 7.5.0 -- An enhanced Interactive Python. Type &#39;?&#39; for help.

In [12]: &gt;? exit

In[15]: t.get_key_bindings?
Signature:
t.get_key_bindings(
    header=&#39;&#39;,
    local_ns=None,
    module=None,
    dummy=None,
    stack_depth=1,
    global_ns=None,
    compile_flags=None,
    **kw,
)
Type:            InteractiveShellEmbed
String form:     &lt;IPython.terminal.embed.InteractiveShellEmbed object at 0x00000189D8331860&gt;
File:            c:\tools\miniconda3\envs\dynamic\lib\site-packages\ipython\terminal\embed.py
Docstring:       &lt;no docstring&gt;
Class docstring: An enhanced, interactive shell for Python.
Init docstring:
Create a configurable given a config config.

Parameters
----------
config : Config
    If this is empty, default values are used. If config is a
    :class:`Config` instance, it will be used to configure the
    instance.
parent : Configurable instance, optional
    The parent Configurable instance of this object.

Notes
-----
Subclasses of Configurable must call the :meth:`__init__` method of
:class:`Configurable` *before* doing anything else and using
:func:`super`::

    class MyConfigurable(Configurable):
        def __init__(self, config=None):
            super(MyConfigurable, self).__init__(config=config)
            # Then any other code you need to finish initialization.

This ensures that instances will be configured properly.
Call docstring:
Activate the interactive interpreter.

__call__(self,header=&#39;&#39;,local_ns=None,module=None,dummy=None) -&gt; Start
the interpreter shell with the given local and global namespaces, and
optionally print a header string at startup.

The shell can be globally activated/deactivated using the
dummy_mode attribute. This allows you to turn off a shell used
for debugging globally.

However, *each* time you call the shell you can override the current
state of dummy_mode with the optional keyword parameter &#39;dummy&#39;. For
example, if you set dummy mode on with IPShell.dummy_mode = True, you
can still have a specific call work by making it as IPShell(dummy=False).

In[16]: _ip.dummy_mode?
Type:        bool
</pre></div>
</div>
</div>
<div class="section" id="source-code-for-creating-ipython-shortcuts">
<h2>2.4. Source code for creating IPython shortcuts<a class="headerlink" href="#source-code-for-creating-ipython-shortcuts" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [2]: </span><span class="o">&gt;&gt;&gt;</span> <span class="o">%</span><span class="k">pycat</span> shortcuts.py
<span class="go">Error: no such file, variable, URL, history range or macro</span>
</pre></div>
</div>
<p>Module to define and register Terminal IPython shortcuts with
<code class="xref py py-mod docutils literal notranslate"><span class="pre">prompt_toolkit</span></code></p>
<p>Copyright (c) IPython Development Team.
Distributed under the terms of the Modified BSD License.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">signal</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Callable</span>

<span class="kn">from</span> <span class="nn">prompt_toolkit.enums</span> <span class="k">import</span> <span class="n">DEFAULT_BUFFER</span><span class="p">,</span> <span class="n">SEARCH_BUFFER</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.filters</span> <span class="k">import</span> <span class="p">(</span><span class="n">HasFocus</span><span class="p">,</span> <span class="n">HasSelection</span><span class="p">,</span> <span class="n">Condition</span><span class="p">,</span>
    <span class="n">ViInsertMode</span><span class="p">,</span> <span class="n">EmacsInsertMode</span><span class="p">,</span> <span class="n">HasCompletions</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.filters.cli</span> <span class="k">import</span> <span class="n">ViMode</span><span class="p">,</span> <span class="n">ViNavigationMode</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.keys</span> <span class="k">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">prompt_toolkit.key_binding.bindings.completion</span> <span class="k">import</span> <span class="n">display_completions_like_readline</span>

<span class="kn">from</span> <span class="nn">IPython.utils.decorators</span> <span class="k">import</span> <span class="n">undoc</span>

<span class="nd">@undoc</span>
<span class="nd">@Condition</span>
<span class="k">def</span> <span class="nf">cursor_in_leading_ws</span><span class="p">(</span><span class="n">cli</span><span class="p">):</span>
    <span class="n">before</span> <span class="o">=</span> <span class="n">cli</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">current_line_before_cursor</span>
    <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="n">before</span><span class="p">)</span> <span class="ow">or</span> <span class="n">before</span><span class="o">.</span><span class="n">isspace</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">register_ipython_shortcuts</span><span class="p">(</span><span class="n">registry</span><span class="p">,</span> <span class="n">shell</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set up the prompt_toolkit keyboard shortcuts for IPython&quot;&quot;&quot;</span>
    <span class="n">insert_mode</span> <span class="o">=</span> <span class="n">ViInsertMode</span><span class="p">()</span> <span class="o">|</span> <span class="n">EmacsInsertMode</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">shell</span><span class="p">,</span> <span class="s1">&#39;handle_return&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">return_handler</span> <span class="o">=</span> <span class="n">shell</span><span class="o">.</span><span class="n">handle_return</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">return_handler</span> <span class="o">=</span> <span class="n">newline_or_execute_outer</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>

    <span class="c1"># Ctrl+J == Enter, seemingly</span>
    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlJ</span><span class="p">,</span>
                         <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span>
                                 <span class="o">&amp;</span> <span class="o">~</span><span class="n">HasSelection</span><span class="p">()</span>
                                 <span class="o">&amp;</span> <span class="n">insert_mode</span>
                        <span class="p">))(</span><span class="n">return_handler</span><span class="p">)</span>

    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlBackslash</span><span class="p">)(</span><span class="n">force_exit</span><span class="p">)</span>

    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlP</span><span class="p">,</span>
                         <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="n">ViInsertMode</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span>
                        <span class="p">))(</span><span class="n">previous_history_or_previous_completion</span><span class="p">)</span>

    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlN</span><span class="p">,</span>
                         <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="n">ViInsertMode</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span>
                        <span class="p">))(</span><span class="n">next_history_or_next_completion</span><span class="p">)</span>

    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlG</span><span class="p">,</span>
                         <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">HasCompletions</span><span class="p">()</span>
                        <span class="p">))(</span><span class="n">dismiss_completion</span><span class="p">)</span>

    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlC</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span>
                        <span class="p">)(</span><span class="n">reset_buffer</span><span class="p">)</span>

    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlC</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">HasFocus</span><span class="p">(</span><span class="n">SEARCH_BUFFER</span><span class="p">)</span>
                        <span class="p">)(</span><span class="n">reset_search_buffer</span><span class="p">)</span>

    <span class="n">supports_suspend</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">(</span><span class="k">lambda</span> <span class="n">cli</span><span class="p">:</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="s1">&#39;SIGTSTP&#39;</span><span class="p">))</span>
    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlZ</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="n">supports_suspend</span>
                        <span class="p">)(</span><span class="n">suspend_to_bg</span><span class="p">)</span>

    <span class="c1"># Ctrl+I == Tab</span>
    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlI</span><span class="p">,</span>
                         <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span>
                                 <span class="o">&amp;</span> <span class="o">~</span><span class="n">HasSelection</span><span class="p">()</span>
                                 <span class="o">&amp;</span> <span class="n">insert_mode</span>
                                 <span class="o">&amp;</span> <span class="n">cursor_in_leading_ws</span>
                        <span class="p">))(</span><span class="n">indent_buffer</span><span class="p">)</span>

    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlO</span><span class="p">,</span>
                         <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span>
                                <span class="o">&amp;</span> <span class="n">EmacsInsertMode</span><span class="p">()))(</span><span class="n">newline_autoindent_outer</span><span class="p">(</span><span class="n">shell</span><span class="o">.</span><span class="n">input_splitter</span><span class="p">))</span>

    <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">F2</span><span class="p">,</span>
                         <span class="nb">filter</span><span class="o">=</span><span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span>
                        <span class="p">)(</span><span class="n">open_input_in_editor</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">shell</span><span class="o">.</span><span class="n">display_completions</span> <span class="o">==</span> <span class="s1">&#39;readlinelike&#39;</span><span class="p">:</span>
        <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlI</span><span class="p">,</span>
                             <span class="nb">filter</span><span class="o">=</span><span class="p">(</span><span class="n">HasFocus</span><span class="p">(</span><span class="n">DEFAULT_BUFFER</span><span class="p">)</span>
                                     <span class="o">&amp;</span> <span class="o">~</span><span class="n">HasSelection</span><span class="p">()</span>
                                     <span class="o">&amp;</span> <span class="n">insert_mode</span>
                                     <span class="o">&amp;</span> <span class="o">~</span><span class="n">cursor_in_leading_ws</span>
                            <span class="p">))(</span><span class="n">display_completions_like_readline</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
        <span class="n">registry</span><span class="o">.</span><span class="n">add_binding</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">ControlV</span><span class="p">,</span>
                             <span class="nb">filter</span><span class="o">=</span><span class="p">(</span>
                             <span class="n">HasFocus</span><span class="p">(</span>
                             <span class="n">DEFAULT_BUFFER</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">ViMode</span><span class="p">()</span>
                            <span class="p">))(</span><span class="n">win_paste</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="startup.html" title="previous chapter">1. IPython Startup Scripts</a></li>
      <li>Next: <a href="magics.html" title="next chapter">3. IPython Magics</a></li>
  </ul></li>
</ul>
<h3><a href="index.html">Table of Contents</a></h3>
<p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="startup.html">1. Startup</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Keybindings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#interactively-binding-keys">2.1. Interactively Binding Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="#official-ipython-documentation">2.2. Official IPython Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-happened-here">2.3. What happened here?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#source-code-for-creating-ipython-shortcuts">2.4. Source code for creating IPython shortcuts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="magics.html">3. Built-in Magics</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_magics.html">4. Writing Your Own Magics</a></li>
<li class="toctree-l1"><a class="reference internal" href="directive.html">5. Sphinx Directives</a></li>
<li class="toctree-l1"><a class="reference internal" href="rich_output.html">6. Rich Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="pygments.html">7. Pygments highlighting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="API.html">API</a></li>
</ul>

  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">2. Keybindings in IPython</a><ul>
<li><a class="reference internal" href="#interactively-binding-keys">2.1. Interactively Binding Keys</a><ul>
<li><a class="reference internal" href="#original-file-implementation">2.1.1. Original File Implementation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#official-ipython-documentation">2.2. Official IPython Documentation</a><ul>
<li><a class="reference internal" href="#pure-prompt-toolkit-way-of-rebinding-keys">2.2.1. Pure Prompt Toolkit Way of Rebinding Keys</a><ul>
<li><a class="reference internal" href="#adding-custom-key-bindings">2.2.1.1. Adding custom key bindings</a></li>
<li><a class="reference internal" href="#enable-key-bindings-according-to-a-condition">2.2.1.2. Enable key bindings according to a condition</a></li>
<li><a class="reference internal" href="#dynamically-switch-between-emacs-and-vi-mode">2.2.1.3. Dynamically switch between Emacs and Vi mode</a></li>
<li><a class="reference internal" href="#using-control-space-for-completion">2.2.1.4. Using control-space for completion</a></li>
<li><a class="reference internal" href="#progress-bar-section">2.2.1.5. Progress Bar Section</a></li>
<li><a class="reference internal" href="#conditional-key-bindings">2.2.1.6. Conditional Key Bindings</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#what-happened-here">2.3. What happened here?</a></li>
<li><a class="reference internal" href="#source-code-for-creating-ipython-shortcuts">2.4. Source code for creating IPython shortcuts</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ipython_keybindings.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="magics.html" title="3. IPython Magics"
             >next</a> |</li>
        <li class="right" >
          <a href="startup.html" title="1. IPython Startup Scripts"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Dynamic IPython 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Copyright (C) 2018-2019 Faris Chugthai.
    </div>
  </body>
</html>